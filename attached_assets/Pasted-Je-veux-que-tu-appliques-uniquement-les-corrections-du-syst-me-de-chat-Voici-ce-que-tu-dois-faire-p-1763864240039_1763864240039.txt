Je veux que tu appliques uniquement les corrections du syst√®me de chat.
Voici ce que tu dois faire pr√©cis√©ment :

1) AJOUTER / REMPLACER LE FICHIER FRONT : client/src/pages/Chat.tsx
Cr√©e ou remplace enti√®rement client/src/pages/Chat.tsx par CE CODE EXACT :
import React, { useEffect, useMemo, useState } from 'react';
import { useUser } from '@/lib/hooks'; 
import { apiRequest } from '@/lib/queryClient';
import { useChat } from '@/hooks/useChat'; 
import { format } from 'date-fns';

const ADMIN_ID = '07356baf-1460-48bd-af7d-ae2ae32247b7'; // ID admin fourni

export default function ChatPageUser() {
  const { user, isLoading: userLoading } = useUser();
  const [room, setRoom] = useState<string | null>(null);
  const [selectedPartnerId, setSelectedPartnerId] = useState<string | undefined>(ADMIN_ID);
  const [text, setText] = useState('');
  const partnerId = selectedPartnerId;

  useEffect(() => {
    if (!user || !partnerId) return;

    let didCancel = false;
    (async () => {
      try {
        const payload = { partnerId };
        const res = await apiRequest('POST', '/api/chat/conversation/init', payload);
        if (!didCancel && res && res.room) {
          setRoom(res.room);
        } else if (!didCancel && res && res.initialized && res.room) {
          setRoom(res.room);
        }
      } catch (err) {
        console.error('[ChatPage] failed to init conversation', err);
      }
    })();

    return () => { didCancel = true; };
  }, [user, partnerId]);

  const chat = useChat({
    room: room || '',
    userId: user?.id || '',
    partnerId: partnerId,
  });

  const messages = chat.messages || [];

  const handleSend = async () => {
    if (!text.trim() || !partnerId) return;
    chat.sendMessage(text.trim(), partnerId);
    setText('');
  };

  const onKeyDown = (e: React.KeyboardEvent<HTMLInputElement>) => {
    if (e.key === 'Enter' && !e.shiftKey) {
      e.preventDefault();
      handleSend();
    }
  };

  if (userLoading) return <div className="p-6">Chargement...</div>;
  if (!user) return <div className="p-6">Connectez-vous pour utiliser le chat.</div>;

  return (
    <div className="p-6 md:p-8 max-w-6xl mx-auto">
      <div className="mb-6 flex items-center justify-between">
        <h1 className="text-2xl font-bold">Chat Support</h1>
        <div className="text-sm text-muted-foreground">
          {partnerId === ADMIN_ID ? 'Admin' : partnerId} ‚Ä¢ {chat.isPartnerOnline ? 'En ligne' : 'Hors ligne'}
        </div>
      </div>

      <div className="grid grid-cols-4 gap-6">
        <aside className="col-span-1">
          <div className="rounded-lg border p-4">
            <h3 className="font-semibold mb-3">Conversation</h3>
            <button
              className={`w-full text-left p-2 rounded ${partnerId === ADMIN_ID ? 'bg-violet-50' : ''}`}
              onClick={() => setSelectedPartnerId(ADMIN_ID)}
            >
              Administrateur
              <div className="text-xs text-muted-foreground">admin@altusfinancesgroup.com</div>
            </button>
          </div>
        </aside>

        <main className="col-span-3">
          <div className="rounded-lg border h-[60vh] flex flex-col">
            <div className="px-6 py-4 border-b">
              <strong>{partnerId === ADMIN_ID ? 'Administrateur' : 'Conversation'}</strong>
            </div>

            <div className="flex-1 overflow-auto p-6 space-y-4">
              {messages.length === 0 && (
                <div className="text-muted-foreground text-center mt-12">Aucune conversation</div>
              )}
              {messages.map((m: any) => {
                const isMe = m.senderId === user.id;
                return (
                  <div key={m.id || `${m.senderId}-${m.createdAt}`} className={`flex ${isMe ? 'justify-end' : 'justify-start'}`}>
                    <div className={`max-w-[70%] p-3 rounded-lg ${isMe ? 'bg-violet-600 text-white' : 'bg-gray-100 text-gray-900'}`}>
                      <div className="text-sm whitespace-pre-wrap">{m.content}</div>
                      <div className="text-xs text-muted-foreground mt-1 text-right">{ format(new Date(m.createdAt), 'PP p') }</div>
                    </div>
                  </div>
                );
              })}
            </div>

            <div className="p-4 border-t">
              <div className="flex gap-3">
                <input
                  aria-label="√âcrire un message"
                  value={text}
                  onChange={(e) => setText(e.target.value)}
                  onKeyDown={onKeyDown}
                  className="flex-1 rounded-lg border px-4 py-2"
                  placeholder={chat.isPartnerOnline ? '√âcrire un message...' : 'L‚Äôutilisateur est hors ligne ‚Äî vous pouvez tout de m√™me envoyer un message.'}
                />
                <button
                  onClick={handleSend}
                  className="rounded-lg bg-violet-600 text-white px-4 py-2 disabled:opacity-40"
                  disabled={!text.trim()}
                >
                  Envoyer
                </button>
              </div>
            </div>
          </div>
        </main>
      </div>
    </div>
  );
}


2) AJOUTER / V√âRIFIER LA ROUTE BACKEND POST /api/chat/conversation/init
Dans server/routes.ts, ajoute CE CODE EXACT (si non existant) :
app.post('/api/chat/conversation/init', requireAuth, async (req, res) => {
  try {
    const userId = req.session.userId;
    const { partnerId } = req.body;
    if (!userId) return res.status(401).json({ error: 'Not authenticated' });
    if (!partnerId) return res.status(400).json({ error: 'partnerId required' });

    const ordered = [userId, partnerId].sort();
    const room = `${ordered[0]}_${ordered[1]}`;

    return res.json({ initialized: true, room });
  } catch (err) {
    console.error('init conversation error', err);
    return res.status(500).json({ error: 'failed' });
  }
});


3) OBJECTIF ATTENDU
Apr√®s avoir appliqu√© ces deux √©l√©ments :


L'utilisateur aura un chat fonctionnel.


La conversation avec l'admin sera initialis√©e automatiquement.


Le hook Socket.IO useChat fonctionnera avec un room jamais null.


La pr√©sence ("en ligne / hors ligne") sera correctement mise √† jour.


Messages en temps r√©el entre utilisateur ‚Üî admin.



üëâ Merci de me confirmer quand c‚Äôest fait pour que je teste avec toi la pr√©sence en temps r√©el.